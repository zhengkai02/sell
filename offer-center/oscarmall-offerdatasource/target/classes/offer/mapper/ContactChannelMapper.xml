<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.iwhalecloud.retail.offer.mapper.ContactChannelMapper">

    <select id="listContactChannel" resultType="com.iwhalecloud.retail.offer.dto.resp.ContactChannelResp">
        select *
          from tbl_contact_channel
          where state = 'A'
    </select>

    <select id="listContactChannelName" resultType="com.iwhalecloud.retail.offer.dto.resp.ContactChannelResp">
        select *
          from tbl_contact_channel
          where state = 'A'
    </select>

    <select id="queryContactChannelAll" resultType="com.iwhalecloud.retail.offer.dto.resp.ContactChannelResp">
        select *
        from tbl_contact_channel
        where state = 'A'
    </select>

    <select id="qryContactChannelList" resultType="com.iwhalecloud.retail.offer.dto.resp.ContactChannelResp">
        select contact_channel_id, channel_type, contact_channel_name, channel_code, pay_center_channel, comments, tenant_id
          from tbl_contact_channel
          where state = 'A'
        <if test="req.contactChannelName != null and req.contactChannelName != ''">
            <bind name="contactChannelName" value="'%' + req.contactChannelName + '%'" />
            and contact_channel_name like #{contactChannelName}
        </if>
        <if test="req.channelCode != null and req.channelCode != ''">
            <bind name="channelCode" value="'%' + req.channelCode + '%'" />
            and channel_code like #{channelCode}
        </if>
    </select>

    <select id="qryContactChannelPage" resultType="com.iwhalecloud.retail.offer.dto.resp.ContactChannelResp">
        select contact_channel_id, channel_type, contact_channel_name, channel_code, pay_center_channel, comments, tenant_id
        from tbl_contact_channel
        where state = 'A'
        <if test="req.contactChannelName != null and req.contactChannelName != ''">
            <bind name="contactChannelName" value="'%' + req.contactChannelName + '%'" />
            and contact_channel_name like #{contactChannelName}
        </if>
        <if test="req.channelCode != null and req.channelCode != ''">
            <bind name="channelCode" value="'%' + req.channelCode + '%'" />
            and channel_code like #{channelCode}
        </if>
    </select>

    <select id="qryContactChannelByContactChannelId" resultType="com.iwhalecloud.retail.offer.dto.resp.QueryContactChannelResp">
          select *
            from tbl_contact_channel
           where contact_channel_id = #{contactChannelId}
           and state = 'A'
    </select>

    <select id="qryContactChannelNameByGoodsId" resultType="java.lang.String">
          select a.contact_channel_name
            from tbl_contact_channel a
            left join tbl_prod_goods_sales_condition b on b.obj_id = a.contact_channel_id
           where b.sales_rule_id = 1
             and b.goods_id = #{goodsId}
             and b.state = 'A'
             and a.state = 'A'
    </select>

</mapper>